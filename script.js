(function(){const O=document.createElement("link").relList;if(O&&O.supports&&O.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))f(g);new MutationObserver(g=>{for(const c of g)if(c.type==="childList")for(const z of c.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&f(z)}).observe(document,{childList:!0,subtree:!0});function b(g){const c={};return g.integrity&&(c.integrity=g.integrity),g.referrerPolicy&&(c.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?c.credentials="include":g.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function f(g){if(g.ep)return;g.ep=!0;const c=b(g);fetch(g.href,c)}})();(function(C){var O={};function b(f){if(O[f])return O[f].exports;var g=O[f]={i:f,l:!1,exports:{}};return C[f].call(g.exports,g,g.exports,b),g.l=!0,g.exports}b.m=C,b.c=O,b.d=function(f,g,c){b.o(f,g)||Object.defineProperty(f,g,{enumerable:!0,get:c})},b.r=function(f){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},b.t=function(f,g){if(1&g&&(f=b(f)),8&g||4&g&&typeof f=="object"&&f&&f.__esModule)return f;var c=Object.create(null);if(b.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:f}),2&g&&typeof f!="string")for(var z in f)b.d(c,z,(function(U){return f[U]}).bind(null,z));return c},b.n=function(f){var g=f&&f.__esModule?function(){return f.default}:function(){return f};return b.d(g,"a",g),g},b.o=function(f,g){return Object.prototype.hasOwnProperty.call(f,g)},b.p="js/",b(b.s=0)})([function(C,O,b){Object.defineProperty(O,"__esModule",{value:!0});var f=function(){function d(l,s){for(var o=0;o<s.length;o++){var y=s[o];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(l,y.key,y)}}return function(l,s,o){return s&&d(l.prototype,s),o&&d(l,o),l}}(),g=z(b(1)),c=z(b(2));function z(d){return d&&d.__esModule?d:{default:d}}var U=new(z(b(3))).default.GyroNorm,S=function(){function d(){(function(l,s){if(!(l instanceof s))throw new TypeError("Cannot call a class as a function")})(this,d),this.container=document.getElementById("gl"),this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas),this.gl=this.canvas.getContext("webgl"),this.ratio=window.devicePixelRatio,this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.mouseX=0,this.mouseY=0,this.mouseTargetX=0,this.mouseTargetY=0,this.imageOriginal=this.container.getAttribute("data-imageOriginal"),this.imageDepth=this.container.getAttribute("data-imageDepth"),this.vth=this.container.getAttribute("data-verticalThreshold"),this.hth=this.container.getAttribute("data-horizontalThreshold"),this.imageURLs=[this.imageOriginal,this.imageDepth],this.textures=[],this.startTime=new Date().getTime(),this.createScene(),this.addTexture(),this.mouseMove(),this.gyro()}return f(d,[{key:"addShader",value:function(l,s){var o=this.gl.createShader(s);if(this.gl.shaderSource(o,l),this.gl.compileShader(o),!this.gl.getShaderParameter(o,this.gl.COMPILE_STATUS))throw new Error("Shader compile error: "+this.gl.getShaderInfoLog(o));this.gl.attachShader(this.program,o)}},{key:"resizeHandler",value:function(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.canvas.width=this.width*this.ratio,this.canvas.height=this.height*this.ratio,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px";var l=void 0,s=void 0;this.height/this.width<this.imageAspect?(l=1,s=this.height/this.width/this.imageAspect):(l=this.width/this.height*this.imageAspect,s=1),this.uResolution.set(this.width,this.height,l,s),this.uRatio.set(1/this.ratio),this.uThreshold.set(this.hth,this.vth),this.gl.viewport(0,0,this.width*this.ratio,this.height*this.ratio)}},{key:"resize",value:function(){this.resizeHandler(),window.addEventListener("resize",this.resizeHandler.bind(this))}},{key:"createScene",value:function(){this.program=this.gl.createProgram(),this.addShader(c.default,this.gl.VERTEX_SHADER),this.addShader(g.default,this.gl.FRAGMENT_SHADER),this.gl.linkProgram(this.program),this.gl.useProgram(this.program),this.uResolution=new N("resolution","4f",this.program,this.gl),this.uMouse=new N("mouse","2f",this.program,this.gl),this.uTime=new N("time","1f",this.program,this.gl),this.uRatio=new N("pixelRatio","1f",this.program,this.gl),this.uThreshold=new N("threshold","2f",this.program,this.gl),this.billboard=new w(this.gl),this.positionLocation=this.gl.getAttribLocation(this.program,"a_position"),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0)}},{key:"addTexture",value:function(){this.gl,function(l,s){for(var o=[],y=l.length,M=function(){--y===0&&s(o)},I=0;I<y;++I){var D=P(l[I],M);o.push(D)}}(this.imageURLs,this.start.bind(this))}},{key:"start",value:function(l){var s=this.gl;this.imageAspect=l[0].naturalHeight/l[0].naturalWidth,console.log(this.imageAspect,"=aspect",this);for(var o=0;o<l.length;o++){var y=s.createTexture();s.bindTexture(s.TEXTURE_2D,y),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,l[o]),this.textures.push(y)}var M=this.gl.getUniformLocation(this.program,"image0"),I=this.gl.getUniformLocation(this.program,"image1");this.gl.uniform1i(M,0),this.gl.uniform1i(I,1),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[0]),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[1]),this.resize(),this.render()}},{key:"gyro",value:function(){var l=this;this.maxTilt=15,U.init({gravityNormalized:!0}).then(function(){U.start(function(s){var o=s.do.gamma,y=s.do.beta;l.mouseTargetY=G(y,-l.maxTilt,l.maxTilt)/l.maxTilt,l.mouseTargetX=-G(o,-l.maxTilt,l.maxTilt)/l.maxTilt})}).catch(function(s){console.log("not supported")})}},{key:"mouseMove",value:function(){var l=this;document.addEventListener("mousemove",function(s){var o=l.windowWidth/2,y=l.windowHeight/2;l.mouseTargetX=(o-s.clientX)/o,l.mouseTargetY=(y-s.clientY)/y})}},{key:"render",value:function(){var l=(new Date().getTime()-this.startTime)/1e3;this.uTime.set(l),this.mouseX+=.05*(this.mouseTargetX-this.mouseX),this.mouseY+=.05*(this.mouseTargetY-this.mouseY),this.uMouse.set(this.mouseX,this.mouseY),this.billboard.render(this.gl),requestAnimationFrame(this.render.bind(this))}}]),d}();function P(d,l){var s=new Image;return s.src=d,s.onload=l,s}function N(d,l,s,o){this.name=d,this.suffix=l,this.gl=o,this.program=s,this.location=o.getUniformLocation(s,d)}function w(d){var l=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,l),d.bufferData(d.ARRAY_BUFFER,w.verts,d.STATIC_DRAW)}function G(d,l,s){return d==d&&(s!==void 0&&(d=d<=s?d:s),l!==void 0&&(d=d>=l?d:l)),d}O.default=S,N.prototype.set=function(){for(var d="uniform"+this.suffix,l=arguments.length,s=Array(l),o=0;o<l;o++)s[o]=arguments[o];var y=[this.location].concat(s);this.gl[d].apply(this.gl,y)},w.verts=new Float32Array([-1,-1,1,-1,-1,1,1,1]),w.prototype.render=function(d){d.drawArrays(d.TRIANGLE_STRIP,0,4)},new S},function(C,O){C.exports=`#ifdef GL_ES
  precision mediump float;
#define GLSLIFY 1
#endif

uniform vec4 resolution;
uniform vec2 mouse;
uniform vec2 threshold;
uniform float time;
uniform float pixelRatio;
uniform sampler2D image0;
uniform sampler2D image1;


vec2 mirrored(vec2 v) {
  vec2 m = mod(v,2.);
  return mix(m,2.0 - m, step(1.0 ,m));
}

void main() {
  // uvs and textures
  vec2 uv = pixelRatio*gl_FragCoord.xy / resolution.xy ;
  vec2 vUv = (uv - vec2(0.5))*resolution.zw + vec2(0.5);
  vUv.y = 1. - vUv.y;
  vec4 tex1 = texture2D(image1,mirrored(vUv));
  // tex1.r = 1. - tex1.r;
  // tex1.r = tex1.r*tex1.r;
  vec2 fake3d = vec2(vUv.x + (tex1.r - 0.5)*mouse.x/threshold.x, vUv.y + (tex1.r - 0.5)*mouse.y/threshold.y);
  vec4 tex0 = texture2D(image0,mirrored(fake3d));
  


  gl_FragColor = vec4(uv,0.,1.);
  gl_FragColor = tex0;
}`},function(C,O){C.exports=`#define GLSLIFY 1
attribute vec2 a_position;

void main() {
  gl_Position = vec4( a_position, 0, 1 );
}`},function(C,O,b){var f,g;(function(c){function z(t){return(t=+t)==0||isNaN(t)?t:t>0?1:-1}function U(t){return new Promise(function(e,u){(function i(a){setTimeout(function(){t&&t.data?e():a>=20?u():i(++a)},50)})(0)})}function S(){M=y?(c.screen.orientation.angle||0)*l:(c.orientation||0)*l}function P(t){for(var e in o.orientation.data=t,o.orientation.callbacks)o.orientation.callbacks[e].call(this)}function N(t){for(var e in o.motion.data=t,o.motion.callbacks)o.motion.callbacks[e].call(this)}if(c.FULLTILT===void 0||c.FULLTILT===null){var w=Math.PI,G=w/2,d=2*w,l=w/180,s=180/w,o={orientation:{active:!1,callbacks:[],data:void 0},motion:{active:!1,callbacks:[],data:void 0}},y=!(!c.screen||!c.screen.orientation||c.screen.orientation.angle===void 0||c.screen.orientation.angle===null),M=(y?c.screen.orientation.angle:c.orientation||0)*l,I=G,D=w,j=d/3,Y=-G,h={version:"0.5.3",getDeviceOrientation:function(t){return new Promise(function(e,u){var i=new h.DeviceOrientation(t);i.start(),new U(o.orientation).then(function(){i._alphaAvailable=o.orientation.data.alpha&&o.orientation.data.alpha!==null,i._betaAvailable=o.orientation.data.beta&&o.orientation.data.beta!==null,i._gammaAvailable=o.orientation.data.gamma&&o.orientation.data.gamma!==null,e(i)}).catch(function(){i.stop(),u("DeviceOrientation is not supported")})})},getDeviceMotion:function(t){return new Promise(function(e,u){var i=new h.DeviceMotion(t);i.start(),new U(o.motion).then(function(){i._accelerationXAvailable=o.motion.data.acceleration&&o.motion.data.acceleration.x,i._accelerationYAvailable=o.motion.data.acceleration&&o.motion.data.acceleration.y,i._accelerationZAvailable=o.motion.data.acceleration&&o.motion.data.acceleration.z,i._accelerationIncludingGravityXAvailable=o.motion.data.accelerationIncludingGravity&&o.motion.data.accelerationIncludingGravity.x,i._accelerationIncludingGravityYAvailable=o.motion.data.accelerationIncludingGravity&&o.motion.data.accelerationIncludingGravity.y,i._accelerationIncludingGravityZAvailable=o.motion.data.accelerationIncludingGravity&&o.motion.data.accelerationIncludingGravity.z,i._rotationRateAlphaAvailable=o.motion.data.rotationRate&&o.motion.data.rotationRate.alpha,i._rotationRateBetaAvailable=o.motion.data.rotationRate&&o.motion.data.rotationRate.beta,i._rotationRateGammaAvailable=o.motion.data.rotationRate&&o.motion.data.rotationRate.gamma,e(i)}).catch(function(){i.stop(),u("DeviceMotion is not supported")})})},Quaternion:function(t,e,u,i){var a;this.set=function(n,r,p,A){this.x=n||0,this.y=r||0,this.z=p||0,this.w=A||1},this.copy=function(n){this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w},this.setFromEuler=function(){var n,r,p,A,x,v,E,T,R,m,_,L;return function(F){return p=((F=F||{}).alpha||0)*l,n=(F.beta||0)*l,r=(F.gamma||0)*l,v=p/2,A=n/2,x=r/2,E=Math.cos(A),T=Math.cos(x),R=Math.cos(v),m=Math.sin(A),_=Math.sin(x),L=Math.sin(v),this.set(m*T*R-E*_*L,E*_*R+m*T*L,E*T*L+m*_*R,E*T*R-m*_*L),this.normalize(),this}}(),this.setFromRotationMatrix=function(){var n;return function(r){return n=r.elements,this.set(.5*Math.sqrt(1+n[0]-n[4]-n[8])*z(n[7]-n[5]),.5*Math.sqrt(1-n[0]+n[4]-n[8])*z(n[2]-n[6]),.5*Math.sqrt(1-n[0]-n[4]+n[8])*z(n[3]-n[1]),.5*Math.sqrt(1+n[0]+n[4]+n[8])),this}}(),this.multiply=function(n){return a=h.Quaternion.prototype.multiplyQuaternions(this,n),this.copy(a),this},this.rotateX=function(n){return a=h.Quaternion.prototype.rotateByAxisAngle(this,[1,0,0],n),this.copy(a),this},this.rotateY=function(n){return a=h.Quaternion.prototype.rotateByAxisAngle(this,[0,1,0],n),this.copy(a),this},this.rotateZ=function(n){return a=h.Quaternion.prototype.rotateByAxisAngle(this,[0,0,1],n),this.copy(a),this},this.normalize=function(){return h.Quaternion.prototype.normalize(this)},this.set(t,e,u,i)}};h.Quaternion.prototype={constructor:h.Quaternion,multiplyQuaternions:function(){var t=new h.Quaternion;return function(e,u){var i=e.x,a=e.y,n=e.z,r=e.w,p=u.x,A=u.y,x=u.z,v=u.w;return t.set(i*v+r*p+a*x-n*A,a*v+r*A+n*p-i*x,n*v+r*x+i*A-a*p,r*v-i*p-a*A-n*x),t}}(),normalize:function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w);return e===0?(t.x=0,t.y=0,t.z=0,t.w=1):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t.w*=e),t},rotateByAxisAngle:function(){var t,e,u=new h.Quaternion,i=new h.Quaternion;return function(a,n,r){return t=(r||0)/2,e=Math.sin(t),i.set((n[0]||0)*e,(n[1]||0)*e,(n[2]||0)*e,Math.cos(t)),u=h.Quaternion.prototype.multiplyQuaternions(a,i),h.Quaternion.prototype.normalize(u)}}()},h.RotationMatrix=function(t,e,u,i,a,n,r,p,A){var x;this.elements=new Float32Array(9),this.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},this.set=function(v,E,T,R,m,_,L,F,X){this.elements[0]=v||1,this.elements[1]=E||0,this.elements[2]=T||0,this.elements[3]=R||0,this.elements[4]=m||1,this.elements[5]=_||0,this.elements[6]=L||0,this.elements[7]=F||0,this.elements[8]=X||1},this.copy=function(v){this.elements[0]=v.elements[0],this.elements[1]=v.elements[1],this.elements[2]=v.elements[2],this.elements[3]=v.elements[3],this.elements[4]=v.elements[4],this.elements[5]=v.elements[5],this.elements[6]=v.elements[6],this.elements[7]=v.elements[7],this.elements[8]=v.elements[8]},this.setFromEuler=function(){var v,E,T,R,m,_,L,F,X;return function(B){return T=((B=B||{}).alpha||0)*l,v=(B.beta||0)*l,E=(B.gamma||0)*l,R=Math.cos(v),m=Math.cos(E),_=Math.cos(T),L=Math.sin(v),F=Math.sin(E),X=Math.sin(T),this.set(_*m-X*L*F,-R*X,m*X*L+_*F,m*X+_*L*F,_*R,X*F-_*m*L,-R*F,L,R*m),this.normalize(),this}}(),this.setFromQuaternion=function(){var v,E,T,R;return function(m){return v=m.w*m.w,E=m.x*m.x,T=m.y*m.y,R=m.z*m.z,this.set(v+E-T-R,2*(m.x*m.y-m.w*m.z),2*(m.x*m.z+m.w*m.y),2*(m.x*m.y+m.w*m.z),v-E+T-R,2*(m.y*m.z-m.w*m.x),2*(m.x*m.z-m.w*m.y),2*(m.y*m.z+m.w*m.x),v-E-T+R),this}}(),this.multiply=function(v){return x=h.RotationMatrix.prototype.multiplyMatrices(this,v),this.copy(x),this},this.rotateX=function(v){return x=h.RotationMatrix.prototype.rotateByAxisAngle(this,[1,0,0],v),this.copy(x),this},this.rotateY=function(v){return x=h.RotationMatrix.prototype.rotateByAxisAngle(this,[0,1,0],v),this.copy(x),this},this.rotateZ=function(v){return x=h.RotationMatrix.prototype.rotateByAxisAngle(this,[0,0,1],v),this.copy(x),this},this.normalize=function(){return h.RotationMatrix.prototype.normalize(this)},this.set(t,e,u,i,a,n,r,p,A)},h.RotationMatrix.prototype={constructor:h.RotationMatrix,multiplyMatrices:function(){var t,e,u=new h.RotationMatrix;return function(i,a){return t=i.elements,e=a.elements,u.set(t[0]*e[0]+t[1]*e[3]+t[2]*e[6],t[0]*e[1]+t[1]*e[4]+t[2]*e[7],t[0]*e[2]+t[1]*e[5]+t[2]*e[8],t[3]*e[0]+t[4]*e[3]+t[5]*e[6],t[3]*e[1]+t[4]*e[4]+t[5]*e[7],t[3]*e[2]+t[4]*e[5]+t[5]*e[8],t[6]*e[0]+t[7]*e[3]+t[8]*e[6],t[6]*e[1]+t[7]*e[4]+t[8]*e[7],t[6]*e[2]+t[7]*e[5]+t[8]*e[8]),u}}(),normalize:function(t){var e=t.elements,u=e[0]*e[4]*e[8]-e[0]*e[5]*e[7]-e[1]*e[3]*e[8]+e[1]*e[5]*e[6]+e[2]*e[3]*e[7]-e[2]*e[4]*e[6];return e[0]/=u,e[1]/=u,e[2]/=u,e[3]/=u,e[4]/=u,e[5]/=u,e[6]/=u,e[7]/=u,e[8]/=u,t.elements=e,t},rotateByAxisAngle:function(){var t,e,u=new h.RotationMatrix,i=new h.RotationMatrix,a=!1;return function(n,r,p){return i.identity(),a=!1,t=Math.sin(p),e=Math.cos(p),r[0]===1&&r[1]===0&&r[2]===0?(a=!0,i.elements[4]=e,i.elements[5]=-t,i.elements[7]=t,i.elements[8]=e):r[1]===1&&r[0]===0&&r[2]===0?(a=!0,i.elements[0]=e,i.elements[2]=t,i.elements[6]=-t,i.elements[8]=e):r[2]===1&&r[0]===0&&r[1]===0&&(a=!0,i.elements[0]=e,i.elements[1]=-t,i.elements[3]=t,i.elements[4]=e),a?(u=h.RotationMatrix.prototype.multiplyMatrices(n,i),u=h.RotationMatrix.prototype.normalize(u)):u=n,u}}()},h.Euler=function(t,e,u){this.set=function(i,a,n){this.alpha=i||0,this.beta=a||0,this.gamma=n||0},this.copy=function(i){this.alpha=i.alpha,this.beta=i.beta,this.gamma=i.gamma},this.setFromRotationMatrix=function(){var i,a,n,r;return function(p){(i=p.elements)[8]>0?(a=Math.atan2(-i[1],i[4]),n=Math.asin(i[7]),r=Math.atan2(-i[6],i[8])):i[8]<0?(a=Math.atan2(i[1],-i[4]),n=-Math.asin(i[7]),n+=n>=0?-w:w,r=Math.atan2(i[6],-i[8])):i[6]>0?(a=Math.atan2(-i[1],i[4]),n=Math.asin(i[7]),r=-G):i[6]<0?(a=Math.atan2(i[1],-i[4]),n=-Math.asin(i[7]),n+=n>=0?-w:w,r=-G):(a=Math.atan2(i[3],i[0]),n=i[7]>0?G:-G,r=0),0>a&&(a+=d),a*=s,n*=s,r*=s,this.set(a,n,r)}}(),this.setFromQuaternion=function(){var i,a,n;return function(r){var p=r.w*r.w,A=r.x*r.x,x=r.y*r.y,v=r.z*r.z,E=p+A+x+v,T=r.w*r.x+r.y*r.z;if(T>.499999*E)i=2*Math.atan2(r.y,r.w),a=G,n=0;else if((1e-6-.5)*E>T)i=-2*Math.atan2(r.y,r.w),a=-G,n=0;else{var R=p-A+x-v,m=2*(r.w*r.z-r.x*r.y),_=p-A-x+v,L=2*(r.w*r.y-r.x*r.z);_>0?(i=Math.atan2(m,R),a=Math.asin(2*T/E),n=Math.atan2(L,_)):(i=Math.atan2(-m,-R),a=-Math.asin(2*T/E),a+=0>a?w:-w,n=Math.atan2(-L,-_))}0>i&&(i+=d),i*=s,a*=s,n*=s,this.set(i,a,n)}}(),this.rotateX=function(i){return h.Euler.prototype.rotateByAxisAngle(this,[1,0,0],i),this},this.rotateY=function(i){return h.Euler.prototype.rotateByAxisAngle(this,[0,1,0],i),this},this.rotateZ=function(i){return h.Euler.prototype.rotateByAxisAngle(this,[0,0,1],i),this},this.set(t,e,u)},h.Euler.prototype={constructor:h.Euler,rotateByAxisAngle:function(){var t=new h.RotationMatrix;return function(e,u,i){return t.setFromEuler(e),t=h.RotationMatrix.prototype.rotateByAxisAngle(t,u,i),e.setFromRotationMatrix(t),e}}()},h.DeviceOrientation=function(t){this.options=t||{};var e=0,u=0;if(this.alphaOffsetScreen=0,this.alphaOffsetDevice=void 0,this.options.type==="game"){var i=(function(n){return n.alpha!==null&&(this.alphaOffsetDevice=new h.Euler(n.alpha,0,0),this.alphaOffsetDevice.rotateZ(-M),++u>=10)?void c.removeEventListener("deviceorientation",i,!1):void(++e>=200&&c.removeEventListener("deviceorientation",i,!1))}).bind(this);c.addEventListener("deviceorientation",i,!1)}else if(this.options.type==="world"){var a=(function(n){return n.absolute!==!0&&n.webkitCompassAccuracy!==void 0&&n.webkitCompassAccuracy!==null&&+n.webkitCompassAccuracy>=0&&+n.webkitCompassAccuracy<50&&(this.alphaOffsetDevice=new h.Euler(n.webkitCompassHeading,0,0),this.alphaOffsetDevice.rotateZ(M),this.alphaOffsetScreen=M,++u>=10)?void c.removeEventListener("deviceorientation",a,!1):void(++e>=200&&c.removeEventListener("deviceorientation",a,!1))}).bind(this);c.addEventListener("deviceorientation",a,!1)}},h.DeviceOrientation.prototype={constructor:h.DeviceOrientation,start:function(t){t&&Object.prototype.toString.call(t)=="[object Function]"&&o.orientation.callbacks.push(t),y?c.screen.orientation.addEventListener("change",S,!1):c.addEventListener("orientationchange",S,!1),o.orientation.active||(c.addEventListener("deviceorientation",P,!1),o.orientation.active=!0)},stop:function(){o.orientation.active&&(c.removeEventListener("deviceorientation",P,!1),o.orientation.active=!1)},listen:function(t){this.start(t)},getFixedFrameQuaternion:function(){var t=new h.Euler,e=new h.RotationMatrix,u=new h.Quaternion;return function(){var i=o.orientation.data||{alpha:0,beta:0,gamma:0},a=i.alpha;return this.alphaOffsetDevice&&(e.setFromEuler(this.alphaOffsetDevice),e.rotateZ(-this.alphaOffsetScreen),t.setFromRotationMatrix(e),t.alpha<0&&(t.alpha+=360),t.alpha%=360,a-=t.alpha),t.set(a,i.beta,i.gamma),u.setFromEuler(t),u}}(),getScreenAdjustedQuaternion:function(){var t;return function(){return(t=this.getFixedFrameQuaternion()).rotateZ(-M),t}}(),getFixedFrameMatrix:function(){var t=new h.Euler,e=new h.RotationMatrix;return function(){var u=o.orientation.data||{alpha:0,beta:0,gamma:0},i=u.alpha;return this.alphaOffsetDevice&&(e.setFromEuler(this.alphaOffsetDevice),e.rotateZ(-this.alphaOffsetScreen),t.setFromRotationMatrix(e),t.alpha<0&&(t.alpha+=360),t.alpha%=360,i-=t.alpha),t.set(i,u.beta,u.gamma),e.setFromEuler(t),e}}(),getScreenAdjustedMatrix:function(){var t;return function(){return(t=this.getFixedFrameMatrix()).rotateZ(-M),t}}(),getFixedFrameEuler:function(){var t,e=new h.Euler;return function(){return t=this.getFixedFrameMatrix(),e.setFromRotationMatrix(t),e}}(),getScreenAdjustedEuler:function(){var t,e=new h.Euler;return function(){return t=this.getScreenAdjustedMatrix(),e.setFromRotationMatrix(t),e}}(),isAbsolute:function(){return!(!o.orientation.data||o.orientation.data.absolute!==!0)},getLastRawEventData:function(){return o.orientation.data||{}},_alphaAvailable:!1,_betaAvailable:!1,_gammaAvailable:!1,isAvailable:function(t){switch(t){case this.ALPHA:return this._alphaAvailable;case this.BETA:return this._betaAvailable;case this.GAMMA:return this._gammaAvailable}},ALPHA:"alpha",BETA:"beta",GAMMA:"gamma"},h.DeviceMotion=function(t){this.options=t||{}},h.DeviceMotion.prototype={constructor:h.DeviceMotion,start:function(t){t&&Object.prototype.toString.call(t)=="[object Function]"&&o.motion.callbacks.push(t),y?c.screen.orientation.addEventListener("change",S,!1):c.addEventListener("orientationchange",S,!1),o.motion.active||(c.addEventListener("devicemotion",N,!1),o.motion.active=!0)},stop:function(){o.motion.active&&(c.removeEventListener("devicemotion",N,!1),o.motion.active=!1)},listen:function(t){this.start(t)},getScreenAdjustedAcceleration:function(){var t=o.motion.data&&o.motion.data.acceleration?o.motion.data.acceleration:{x:0,y:0,z:0},e={};switch(M){case I:e.x=-t.y,e.y=t.x;break;case D:e.x=-t.x,e.y=-t.y;break;case j:case Y:e.x=t.y,e.y=-t.x;break;default:e.x=t.x,e.y=t.y}return e.z=t.z,e},getScreenAdjustedAccelerationIncludingGravity:function(){var t=o.motion.data&&o.motion.data.accelerationIncludingGravity?o.motion.data.accelerationIncludingGravity:{x:0,y:0,z:0},e={};switch(M){case I:e.x=-t.y,e.y=t.x;break;case D:e.x=-t.x,e.y=-t.y;break;case j:case Y:e.x=t.y,e.y=-t.x;break;default:e.x=t.x,e.y=t.y}return e.z=t.z,e},getScreenAdjustedRotationRate:function(){var t=o.motion.data&&o.motion.data.rotationRate?o.motion.data.rotationRate:{alpha:0,beta:0,gamma:0},e={};switch(M){case I:e.beta=-t.gamma,e.gamma=t.beta;break;case D:e.beta=-t.beta,e.gamma=-t.gamma;break;case j:case Y:e.beta=t.gamma,e.gamma=-t.beta;break;default:e.beta=t.beta,e.gamma=t.gamma}return e.alpha=t.alpha,e},getLastRawEventData:function(){return o.motion.data||{}},_accelerationXAvailable:!1,_accelerationYAvailable:!1,_accelerationZAvailable:!1,_accelerationIncludingGravityXAvailable:!1,_accelerationIncludingGravityYAvailable:!1,_accelerationIncludingGravityZAvailable:!1,_rotationRateAlphaAvailable:!1,_rotationRateBetaAvailable:!1,_rotationRateGammaAvailable:!1,isAvailable:function(t){switch(t){case this.ACCELERATION_X:return this._accelerationXAvailable;case this.ACCELERATION_Y:return this._accelerationYAvailable;case this.ACCELERATION_Z:return this._accelerationZAvailable;case this.ACCELERATION_INCLUDING_GRAVITY_X:return this._accelerationIncludingGravityXAvailable;case this.ACCELERATION_INCLUDING_GRAVITY_Y:return this._accelerationIncludingGravityYAvailable;case this.ACCELERATION_INCLUDING_GRAVITY_Z:return this._accelerationIncludingGravityZAvailable;case this.ROTATION_RATE_ALPHA:return this._rotationRateAlphaAvailable;case this.ROTATION_RATE_BETA:return this._rotationRateBetaAvailable;case this.ROTATION_RATE_GAMMA:return this._rotationRateGammaAvailable}},ACCELERATION_X:"accelerationX",ACCELERATION_Y:"accelerationY",ACCELERATION_Z:"accelerationZ",ACCELERATION_INCLUDING_GRAVITY_X:"accelerationIncludingGravityX",ACCELERATION_INCLUDING_GRAVITY_Y:"accelerationIncludingGravityY",ACCELERATION_INCLUDING_GRAVITY_Z:"accelerationIncludingGravityZ",ROTATION_RATE_ALPHA:"rotationRateAlpha",ROTATION_RATE_BETA:"rotationRateBeta",ROTATION_RATE_GAMMA:"rotationRateGamma"},c.FULLTILT=h}})(window),g={GyroNorm:function(){function c(a){return Math.round(a*Math.pow(10,t))/Math.pow(10,t)}function z(){var a={};a=u?I.getScreenAdjustedEuler():I.getFixedFrameEuler();var n=D.getScreenAdjustedAcceleration(),r=D.getScreenAdjustedAccelerationIncludingGravity(),p=D.getScreenAdjustedRotationRate(),A=0;h===S?A=0>(A=a.alpha-s)?360-Math.abs(A):A:A=a.alpha;var x={do:{alpha:c(A),beta:c(a.beta),gamma:c(a.gamma),absolute:I.isAbsolute()},dm:{x:c(n.x),y:c(n.y),z:c(n.z),gx:c(r.x),gy:c(r.y),gz:c(r.z),alpha:c(p.alpha),beta:c(p.beta),gamma:c(p.gamma)}};return Y&&(x.dm.gx*=o,x.dm.gy*=o,x.dm.gz*=o),x}function U(a){e&&(typeof a=="string"&&(a={message:a,code:0}),e(a))}var S="game",P="world",N="deviceorientation",w="acceleration",G="accelerationinludinggravity",d="rotationrate",l=null,s=0,o=0,y=!1,M=!1,I=null,D=null,j=50,Y=!0,h=S,t=2,e=null,u=!1,i=function(a){};return i.GAME=S,i.WORLD=P,i.DEVICE_ORIENTATION=N,i.ACCELERATION=w,i.ACCELERATION_INCLUDING_GRAVITY=G,i.ROTATION_RATE=d,i.prototype.init=function(a){a&&a.frequency&&(j=a.frequency),a&&a.gravityNormalized&&(Y=a.gravityNormalized),a&&a.orientationBase&&(h=a.orientationBase),a&&typeof a.decimalCount=="number"&&a.decimalCount>=0&&(t=parseInt(a.decimalCount)),a&&a.logger&&(e=a.logger),a&&a.screenAdjusted&&(u=a.screenAdjusted);var n=new FULLTILT.getDeviceOrientation({type:h}).then(function(p){I=p}),r=new FULLTILT.getDeviceMotion().then(function(p){o=(D=p).getScreenAdjustedAccelerationIncludingGravity().z>0?-1:1});return Promise.all([n,r]).then(function(){M=!0})},i.prototype.end=function(){try{M=!1,this.stop(),D.stop(),I.stop()}catch(a){U(a)}},i.prototype.start=function(a){return M?(l=setInterval(function(){a(z())},j),void(y=!0)):void U({message:'GyroNorm is not initialized yet. First call the "init()" function.',code:1})},i.prototype.stop=function(){l&&(clearInterval(l),y=!1)},i.prototype.normalizeGravity=function(a){Y=!!a},i.prototype.setHeadDirection=function(){return!u&&h!==P&&(s=I.getFixedFrameEuler().alpha,!0)},i.prototype.startLogging=function(a){a&&(e=a)},i.prototype.stopLogging=function(){e=null},i.prototype.isAvailable=function(a){var n=I.getScreenAdjustedEuler(),r=D.getScreenAdjustedAcceleration(),p=D.getScreenAdjustedAccelerationIncludingGravity(),A=D.getScreenAdjustedRotationRate();switch(a){case N:return n.alpha&&n.alpha!==null&&n.beta&&n.beta!==null&&n.gamma&&n.gamma!==null;case w:return r&&r.x&&r.y&&r.z;case G:return p&&p.x&&p.y&&p.z;case d:return A&&A.alpha&&A.beta&&A.gamma;default:return{deviceOrientationAvailable:n.alpha&&n.alpha!==null&&n.beta&&n.beta!==null&&n.gamma&&n.gamma!==null,accelerationAvailable:r&&r.x&&r.y&&r.z,accelerationIncludingGravityAvailable:p&&p.x&&p.y&&p.z,rotationRateAvailable:A&&A.alpha&&A.beta&&A.gamma}}},i.prototype.isRunning=function(){return y},i}()},(f=(function(){return g}).call(O,b,O,C))===void 0||(C.exports=f)}]);

